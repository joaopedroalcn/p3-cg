<!DOCTYPE html>
<html>
  <head>
    <style>
      canvas {
        border: 1px solid black;
      }
    </style>
  </head>
  <body>
    <label for="near">Distância Near:</label>
    <input type="range" id="near" min="1" max="100" value="10" /><br />

    <label for="far">Distância Far:</label>
    <input type="range" id="far" min="10" max="1000" value="100" /><br />

    <label for="cameraX">Posição da Câmera X:</label>
    <input
      type="range"
      id="cameraX"
      min="-10"
      max="10"
      step="0.1"
      value="0"
    /><br />

    <label for="cameraY">Posição da Câmera Y:</label>
    <input
      type="range"
      id="cameraY"
      min="-10"
      max="10"
      step="0.1"
      value="0"
    /><br />

    <label for="cameraZ">Posição da Câmera Z:</label>
    <input
      type="range"
      id="cameraZ"
      min="-10"
      max="10"
      step="0.1"
      value="5"
    /><br />

    <label for="fovy">Ângulo Vertical do Campo de Visão (fovy):</label>
    <input type="range" id="fovy" min="30" max="120" value="60" /><br />

    <canvas id="canvas" width="800" height="600"></canvas>

    <script>
      // Função para atualizar a cena
      function updateScene() {
        const near = parseInt(document.getElementById("near").value);
        const far = parseInt(document.getElementById("far").value);
        const cameraX = parseFloat(document.getElementById("cameraX").value);
        const cameraY = parseFloat(document.getElementById("cameraY").value);
        const cameraZ = parseFloat(document.getElementById("cameraZ").value);
        const fovy = parseInt(document.getElementById("fovy").value);

        // Limpar o canvas
        const canvas = document.getElementById("canvas");
        const ctx = canvas.getContext("2d");
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        // Calcular a projeção perspectiva
        const aspectRatio = canvas.width / canvas.height;
        const fovRad = fovy * (Math.PI / 180);
        const f = 1 / Math.tan(fovRad / 2);
        const rangeInv = 1 / (far - near);

        // Exemplo de objeto 3D (um simples cubo)
        const cubeVertices = [
          [-1, -1, -1],
          [1, -1, -1],
          [1, 1, -1],
          [-1, 1, -1],
          [-1, -1, 1],
          [1, -1, 1],
          [1, 1, 1],
          [-1, 1, 1],
        ];

        // Converter coordenadas 3D para 2D e desenhar no canvas
        cubeVertices.forEach((vertex) => {
          const x = vertex[0] - cameraX;
          const y = vertex[1] - cameraY;
          const z = vertex[2] - cameraZ;

          const x2d = (f * x) / (z * aspectRatio) + canvas.width / 2;
          const y2d = (-f * y) / z + canvas.height / 2;

          ctx.fillRect(x2d, y2d, 5, 5);
        });
      }

      // Atualizar a cena quando os parâmetros forem alterados
      const inputs = document.querySelectorAll('input[type="range"]');
      inputs.forEach((input) => {
        input.addEventListener("input", updateScene);
      });

      // Inicializar a cena
      updateScene();
    </script>
  </body>
</html>
